{#{% extends "layout.html.twig" %}#}

{#{% block title %}Hello CartController!#}
{#{% endblock %}#}

{#{% block body %}#}
    {#<div class="bg-light p-3">#}
        {#<h1>Votre panier</h1>#}
    {#</div>#}

    {#{% if items | length > 0 %}#}
        {#<table class="table table-light">#}
            {#<thead>#}
            {#<tr>#}
                {#<th scope="col">Produit</th>#}
                {#<th scope="col">Horraire</th>#}
                {#<th scope="col">Prix</th>#}
                {#<th scope="col">Quantité</th>#}
                {#<th scope="col">Total</th>#}
            {#</tr>#}
            {#</thead>#}
            {#<tbody>#}
            {#{% for item in items %}#}
            {#<tr>#}
                {#<th scope="row">{{ item.product.name }}</th>#}
                {#<td> XXX </td>#}
                {#<td>{{ item.product.amount }} euros</td>#}
                {#<td>{{ item.quantity }}</td>#}
                {#<td>{{ item.product.amount * item.quantity }} euros</td>#}
            {#</tr>#}
            {#{% endfor %}#}

            {#</tbody>#}
            {#{% for item in item.product.orderItems %}#}
                {#{{ item  }}#}
            {#{% endfor %}#}


            {#{% endfor %}#}
            {#<td class="text-dark">#}
                {#{{ render(controller(#}
                    {#'App\\Controller\\BookingController::getSlots',#}
                    {#{'price':0, 'worker' : items[0].product.saloon.workers, 'auto': false}#}
                {#)) }}#}
            {#</td>#}
            {#<tr>#}
                {#<td colspan="3" class="text-right">Total:</td>#}
                {#<td>{{ total }} euros</td>#}
            {#</tr>#}
            {#<td>#}
            {#<a class="btn btn-success float-right"#}
            {#href="{{ path('saloon_public_booking', {'price': items[0].product.id  }) }}">#}
            {#Procéder au paiement#}
            {#</a>#}
            {#</td>}#}

        {#</table>#}
    {#{% else %}#}

    {#<p>Surprise, c'est vide !</p>#}
    {#{% endif %}#}

{#{% endblock %}#}
{% extends 'layout.html.twig' %}

{% block title %}Panier{% endblock %}

{% block body %}
    <main role="main">

        {#<h2 class="mt-3">{{ 'my_cart'|trans }}</h2>#}

        {% include "partials/products.html.twig" %}
        {% set client_secret =  intent.client_secret %}

        <div class="col-4 offset-4 my-5">
            {{ form_start(form, {'attr': {'id': 'payment-form', 'data-secret': intent.client_secret}}) }}

            <div id="card-errors" role="alert"></div>
            <div id="card-element" class="mb-3">
                <!-- Elements will create input elements here -->
            </div>

            {{ form_row(form.email) }}

            <button type="submit" class="btn btn-primary">Commander - {{ intent.amount / 100 }}€</button>
            {#<a class="btn btn-success float-right"#}
               {#href="{{ path('saloon_public_booking', {'price': items[0].product.id  }) }}">#}
                {#Procéder au paiement#}
            {#</a>#}
            {{ form_end(form) }}
        </div>

    </main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://js.stripe.com/v3/"></script>
    {{ encore_entry_script_tags('stripe') }}
{% endblock %}
